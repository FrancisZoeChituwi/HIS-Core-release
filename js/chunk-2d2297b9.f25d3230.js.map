{"version":3,"sources":["webpack:///./src/apps/LOS/views/Reports/TestRequestedReport.vue?e271","webpack:///./src/apps/LOS/views/Reports/TestRequestedReport.vue","webpack:///./src/apps/LOS/views/Reports/TestRequestedReport.vue?0ac9"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_report_template","title","period","rows","fields","columns","canExportCsv","canExportPDf","reportReady","onReportConfiguration","onPeriod","mixins","ReportMixin","components","ReportTemplate","data","cohort","reportType","patientLevelColumns","thTxt","disaggregatedColumns","created","this","report","getFormFields","methods","type","tests","getDateIntervalPeriod","value","setDisaggregatedRows","setPatientLevelRows","getDateDurationFields","id","helpText","TT_MULTIPLE_SELECT","options","_","x","config","setStartDate","start_date","setEndDate","end_date","getSamplesDrawnReport","availableTests","buildAvailableTests","buildAvailableTestOptions","TT_SELECT","label","orders","forEach","order","test","push","testName","result","length","other","results","males","females","concat","map","i","ageGroupIndex","group","maleRow","td","femaleRow","filterByGender","gender","filter","age_group","drill","d","arv_number","tdDate","birthdate","order_date","join","reason_for_test","__exports__"],"mappings":"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","file":"js/chunk-2d2297b9.f25d3230.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_report_template = _resolveComponent(\"report-template\")\n\n  return (_openBlock(), _createBlock(_component_report_template, {\n    title: _ctx.title,\n    period: _ctx.period,\n    rows: _ctx.rows,\n    fields: _ctx.fields,\n    columns: _ctx.columns,\n    canExportCsv: true,\n    canExportPDf: true,\n    reportReady: _ctx.reportReady,\n    onReportConfiguration: _ctx.onPeriod\n  }, null, 8, [\"title\", \"period\", \"rows\", \"fields\", \"columns\", \"reportReady\", \"onReportConfiguration\"]))\n}","\nimport { defineComponent } from 'vue'\nimport { LabReportService } from \"@/apps/ART/services/reports/lab_report_service\"\nimport ReportMixin from \"@/apps/ART/views/reports/ReportMixin.vue\"\nimport ReportTemplate from \"@/apps/ART/views/reports/TableReportTemplate.vue\"\nimport { AGE_GROUPS } from \"@/apps/ART/services/reports/patient_report_service\"\nimport { FieldType } from '@/components/Forms/BaseFormElements'\nimport { Field } from '@/components/Forms/FieldInterface'\nimport { Option } from '@/components/Forms/FieldInterface'\nimport table from \"@/components/DataViews/tables/ReportDataTable\"\n\nexport default defineComponent({\n    mixins: [ReportMixin],\n    components: { ReportTemplate },\n    data: () => ({\n        title: 'Tests requested',\n        rows: [] as Array<any>,\n        cohort: [] as Array<any>,\n        reportType: '' as string,\n        reportReady: false as boolean,\n        columns: [] as Array<any>,\n        patientLevelColumns:[ \n            [\n                table.thTxt('ARV#'), \n                table.thTxt('Gender'), \n                table.thTxt('Birthdate'), \n                table.thTxt('Ordered Date'), \n                table.thTxt('Test'), \n                table.thTxt('Reason')\n            ]\n        ],\n        disaggregatedColumns: [\n            table.thTxt('Age group'), \n            table.thTxt('Gender')\n        ]\n    }),\n    created() {\n        this.report = new LabReportService()\n        this.fields = this.getFormFields()\n    },\n    methods: {\n        async onPeriod({type, tests}: any) {\n            this.reportReady = true\n            this.rows = []\n            this.period = this.report.getDateIntervalPeriod()\n            this.reportType = type.value\n            if (this.reportType === 'disaggregated') {\n                this.setDisaggregatedRows(tests)\n            } else if (this.reportType === 'patient_level') {\n                this.setPatientLevelRows(tests)\n            }\n        },\n        getFormFields(): Array<Field> {\n            return [\n                ...this.getDateDurationFields(),\n                {\n                    id: 'tests',\n                    helpText: 'Test(s) Requested',\n                    type: FieldType.TT_MULTIPLE_SELECT,\n                    options: async (_: any, x: any, config: any) => {\n                        this.report.setStartDate(config.start_date)\n                        this.report.setEndDate(config.end_date)\n                        const data = await this.report.getSamplesDrawnReport()\n                        const availableTests = this.buildAvailableTests(data)\n                        return this.buildAvailableTestOptions(availableTests)\n                    } \n                },\n                {\n                    id: 'type',\n                    helpText: 'Select report type',\n                    type: FieldType.TT_SELECT,\n                    options: () => [\n                        {\n                            label: 'Disaggregated',\n                            value: 'disaggregated',\n                        },\n                        {\n                            label: 'Patient level',\n                            value: 'patient_level',\n                        }\n                    ]\n                }\n            ]\n        },\n        buildAvailableTests(orders: any) {\n            const tests: Record<string, any> = {}\n            orders.forEach((order: any) => {\n                order.tests.forEach((test: any) => {\n                    if (!(test in tests)) {\n                        tests[test] = []\n                    }\n                    tests[test].push(order)\n                })\n            })\n            return tests\n        },\n        buildAvailableTestOptions(availableTests: Record<string, any>) {\n            const options: Array<Option> = []\n            for(const testName in availableTests) {\n                const result = availableTests[testName]\n                options.push({\n                    label: testName,\n                    value: result.length,\n                    other: result\n                })\n            }\n            return options\n        },\n        setDisaggregatedRows(results: Array<Option>) {\n            const males = []\n            const females = []\n            this.columns = [this.disaggregatedColumns.concat(results.map((i: any) => table.thTxt(i.label)))]\n            for(const ageGroupIndex in AGE_GROUPS) {\n                const group = AGE_GROUPS[ageGroupIndex]\n                const maleRow: any = [table.td(group), table.td('M')]\n                const femaleRow: any = [table.td(group), table.td('F')]\n                results.forEach(({other}: Option) => {\n                    const filterByGender = (gender: 'F' | 'M') => {\n                        return other.filter(\n                            (i: any) => i.gender === gender && i.age_group === group\n                        ).map((i: any) => i.patient_id)\n                    }\n                    maleRow.push(this.drill(filterByGender('M'), `Males of ${group}`))\n                    femaleRow.push(this.drill(filterByGender('F'), `Females of ${group}`))\n                })\n                males.push(maleRow)\n                females.push(femaleRow)\n                this.rows = [...females, ...males]\n            }\n        },\n        setPatientLevelRows(results: Array<Option>) {\n            this.columns = this.patientLevelColumns\n            results.forEach(({other}: Option)  => {\n                other.forEach((d: any) => {\n                    this.rows.push([\n                        table.td(d.arv_number),\n                        table.td(d.gender),\n                        table.tdDate(d.birthdate),\n                        table.tdDate(d.order_date),\n                        table.td(d.tests.join(',')),\n                        table.td(d.reason_for_test)\n                    ])\n                })\n            })\n        }\n    }\n})\n","import { render } from \"./TestRequestedReport.vue?vue&type=template&id=3bf60ebf&ts=true\"\nimport script from \"./TestRequestedReport.vue?vue&type=script&lang=ts\"\nexport * from \"./TestRequestedReport.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}