{"version":3,"sources":["webpack:///./src/apps/ART/views/reports/inconsistencies/PatientVisitStats.vue?5acd","webpack:///./src/apps/ART/views/reports/inconsistencies/PatientVisitStats.vue","webpack:///./src/apps/ART/views/reports/inconsistencies/PatientVisitStats.vue?524e"],"names":["_hoisted_1","_hoisted_2","class","_hoisted_3","render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_component_ion_title","_component_ion_toolbar","_component_ion_header","_component_apexchart","_component_view_port","_component_ion_content","_component_ion_button","_component_ion_footer","_component_ion_page","onOnFinish","onPeriod","skipSummary","fields","canShowReport","key","default","_","width","height","type","chartType","options","chartOptions","series","onClick","pointSelection","color","slot","size","components","IonPage","IonHeader","IonTitle","IonToolbar","IonContent","IonFooter","IonButton","ViewPort","HisStandardForm","mixins","ReportMixin","data","report","patientPresent","guardianPresent","bothPresent","title","text","yaxis","plotAreaHeight","xaxis","created","this","getDateDurationFields","methods","conf","presentLoading","setStartDate","start_date","setEndDate","end_date","getPatientVisitTypes","res","buildSeries","dismiss","create","message","backdropDismiss","loading","present","e","c","config","dataPointIndex","seriesIndex","sIndex","runTableDrill","raw","visitDates","Object","keys","setValueGroup","date","group","comparator","values","entries","filter","v","patient_present","guardian_present","map","patient","sortSeries","valueGroup","Date","getTime","length","sortData","guardian","name","__exports__"],"mappings":"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","file":"js/chunk-2d238053.1dbcd64f.js","sourcesContent":["import { resolveComponent as _resolveComponent, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\" Patient visit report \")\nconst _hoisted_2 = { class: \"view-port-content\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" Finish \")\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_title = _resolveComponent(\"ion-title\")\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")\n  const _component_ion_header = _resolveComponent(\"ion-header\")\n  const _component_apexchart = _resolveComponent(\"apexchart\")\n  const _component_view_port = _resolveComponent(\"view-port\")\n  const _component_ion_content = _resolveComponent(\"ion-content\")\n  const _component_ion_button = _resolveComponent(\"ion-button\")\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_Fragment, null, [\n    _withDirectives(_createVNode(_component_his_standard_form, {\n      onOnFinish: _ctx.onPeriod,\n      skipSummary: true,\n      fields: _ctx.fields\n    }, null, 8, [\"onOnFinish\", \"fields\"]), [\n      [_vShow, !_ctx.canShowReport]\n    ]),\n    (_ctx.canShowReport)\n      ? (_openBlock(), _createBlock(_component_ion_page, { key: 0 }, {\n          default: _withCtx(() => [\n            _createVNode(_component_ion_header, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_ion_toolbar, null, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_title, null, {\n                      default: _withCtx(() => [\n                        _hoisted_1\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_ion_content, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_view_port, null, {\n                  default: _withCtx(() => [\n                    _createVNode(\"div\", _hoisted_2, [\n                      _createVNode(_component_apexchart, {\n                        width: _ctx.width,\n                        height: _ctx.height,\n                        type: _ctx.chartType,\n                        options: _ctx.chartOptions,\n                        series: _ctx.series,\n                        onClick: _ctx.pointSelection\n                      }, null, 8, [\"width\", \"height\", \"type\", \"options\", \"series\", \"onClick\"])\n                    ])\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_ion_footer, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_ion_toolbar, { color: \"dark\" }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_button, {\n                      slot: \"end\",\n                      size: \"large\",\n                      \"router-link\": \"/\",\n                      color: \"success\"\n                    }, {\n                      default: _withCtx(() => [\n                        _hoisted_3\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true)\n  ], 64 /* STABLE_FRAGMENT */))\n}","\nimport { defineComponent } from 'vue'\nimport {\n    IonPage,\n    IonHeader,\n    IonTitle,\n    IonToolbar,\n    IonContent,\n    IonFooter,\n    IonButton,\n    loadingController\n} from \"@ionic/vue\"\nimport ViewPort from \"@/components/DataViews/ViewPort.vue\"\nimport { PatientReportService } from \"@/apps/ART/services/reports/patient_report_service\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport ReportMixin from \"@/apps/ART/views/reports/ReportMixin.vue\"\nimport { uniq } from 'lodash';\n\nexport default defineComponent({\n    components: {\n        IonPage,\n        IonHeader,\n        IonTitle,\n        IonToolbar,\n        IonContent,\n        IonFooter,\n        IonButton,\n        ViewPort,\n        HisStandardForm\n    },\n    mixins: [ReportMixin],\n    data: () => ({\n        chartType: 'area',\n        height: '100%',\n        width: '100%',\n        canShowReport: false,\n        report: {} as any,\n        series: [] as any,\n        patientPresent: {} as any,\n        guardianPresent: {} as any,\n        bothPresent: {} as any,\n        chartOptions: {\n            title : {\n                text: \"HIV Reception encounters\"\n            },\n            yaxis: {\n                title: { \n                    text: \"Number of clients\"\n                },\n                plotAreaHeight: 800,\n            },\n            xaxis: {\n                type: 'datetime'\n            }\n        } as any\n    }),\n    created() {\n        this.fields = this.getDateDurationFields()\n    },\n    methods: {\n        async onPeriod(_: any, conf: any) {\n            await this.presentLoading()\n            this.canShowReport = true\n            this.report = new PatientReportService()\n            this.report.setStartDate(conf.start_date)\n            this.report.setEndDate(conf.end_date)\n            const res = await this.report.getPatientVisitTypes()\n            this.series = this.buildSeries(res)\n            loadingController.dismiss()\n        },\n        async presentLoading() {\n            const loading = await loadingController\n                .create({\n                    message: 'Please wait...',\n                    backdropDismiss: false\n                })\n            await loading.present()\n        },\n        pointSelection(e: any, c: any, config: any) {\n            try {\n                const { dataPointIndex, seriesIndex } = config\n                const sIndex = seriesIndex <= 0 ? 0 : seriesIndex\n                this.runTableDrill(this.series[sIndex].raw[dataPointIndex])\n            } catch (e) {\n                //TODO\n            }\n        },\n        buildSeries(data: any) {\n            const visitDates: string[] = uniq(Object.keys(data))\n            const setValueGroup = (\n                date: string,\n                group: Record<string, any>,\n                comparator: any) => {\n\n                if (!(date in group)) group[date] = []\n\n                const values = Object.entries(data[date])\n                    .filter(([_, v]: any) => comparator(\n                        v.patient_present,\n                        v.guardian_present\n                    ))\n                    .map(([patient]) => patient)\n\n                group[date] = [...group[date], ...values]\n                return group\n            }\n\n            const sortSeries = (valueGroup: any) => {\n                return visitDates.map((date: string) => [\n                    new Date(date).getTime(), \n                    valueGroup[date].length\n                ])\n            }\n\n            const sortData = (valueGroup: any) => visitDates.map((date: string) => valueGroup[date])\n    \n            for(const date in data) {\n                setValueGroup(date, this.patientPresent, (patient: any, guardian: any) => {\n                    return patient && !guardian\n                })\n                setValueGroup(date, this.guardianPresent, (patient: any, guardian: any) => {\n                    return !patient && guardian\n                })\n                setValueGroup(date, this.bothPresent, (patient: any, guardian: any) => {\n                    return patient && guardian\n                })\n            }\n\n            return [\n                {\n                    name: 'Patient present',\n                    raw: sortData(this.patientPresent),\n                    data: sortSeries(this.patientPresent)\n                },\n                {\n                    name: 'Guardian present',\n                    raw: sortData(this.guardianPresent),\n                    data: sortSeries(this.guardianPresent)\n                },\n                {\n                    name: 'Both patient and guardian present',\n                    raw: sortData(this.bothPresent),\n                    data: sortSeries(this.bothPresent)\n                }\n            ]\n        }\n    }\n})\n","import { render } from \"./PatientVisitStats.vue?vue&type=template&id=5f54bf6b&ts=true\"\nimport script from \"./PatientVisitStats.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientVisitStats.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}