{"version":3,"sources":["webpack:///./src/apps/OPD/views/encounters/Prescription.vue?a71d","webpack:///./src/apps/OPD/services/drug_prescription_service.ts","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?51ab","webpack:///./src/apps/OPD/components/FrequencyCard.vue?2048","webpack:///./src/apps/OPD/components/FrequencyCard.vue","webpack:///./src/apps/OPD/components/FrequencyCard.vue?e558","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?7cba","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?ad05","webpack:///./src/apps/OPD/components/PrescriptionModal.vue","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?0287","webpack:///./src/apps/OPD/views/encounters/Prescription.vue","webpack:///./src/apps/OPD/views/encounters/Prescription.vue?b134","webpack:///./src/apps/OPD/components/FrequencyCard.vue?a5ed","webpack:///./src/components/Keyboard/HisIntervalKeyboard.vue?522a","webpack:///./src/apps/OPD/components/PrescriptionModal.vue?ba65"],"names":["_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","cancelDestinationPath","cancelDestination","fields","activeField","onFinishAction","onSubmit","DRUG_DOSE_FREQUENCIES","1","2","3","4","ANTI_MALARIA_DRUGS","patientID","providerID","drugs","filter","DrugPrescriptionService","getJson","name","this","map","drug","label","value","other","getMalariaTestResult","malariaTestResult","getMalariaDiagnosis","malariaDiagnosis","getFirstValueCoded","getFirstValueText","drugOrders","create","encounterID","_withId","_hoisted_1","_hoisted_2","class","_hoisted_3","_hoisted_4","_component_ion_title","_component_ion_toolbar","_component_ion_header","_component_ion_label","_component_ion_item","_component_ion_list","_component_ion_col","_component_frequency_card","_component_ion_row","_component_interval_keyboard","_component_ion_grid","_component_ion_content","_component_ion_button","_component_ion_footer","default","_","style","overflowY","background","size","height","borderRight","index","key","detail","onClick","activeIndex","color","instructions","Object","keys","frequencies","title","status","$event","setFrequency","unit","onOnValue","setDuration","closeModal","slot","savePrescriptions","_component_ion_card_subtitle","_component_ion_card_content","_component_ion_card","active","src","icon","alt","cardTitle","props","type","String","required","Boolean","components","IonCard","IonCardContent","IonCardSubtitle","setup","Strings","capitalizeFirstLetter","__exports__","_component_his_keyboard","ranges","range","generateKeypad","start","end","keyboard","kbConfig","onKeyPress","disabled","HisKeyboard","IonRow","IonCol","IonList","IonItem","IonLabel","emits","emit","text","numbers","row","counter","i","push","findIndex","r","prescribedDrugs","d","duration","frequency","morning","noon","evening","night","getFrequencyCount","values","length","drugname","freq","parseInt","isComplete","dismiss","IonContent","IonButton","IonHeader","IonTitle","IonToolbar","FrequencyCard","IntervalKeyboard","HisStandardForm","mixins","EncounterMixin","data","prescriptionService","hasMalaria","watch","ready","handler","isReady","loadDrugs","getFields","immediate","deep","methods","createEncounter","encounter","createDrugOrder","drugOrder","nextTask","getPrescriptionDetails","component","PrescriptionModal","backdropDismiss","cssClass","componentProps","modal","present","onDidDismiss","calculateExpireDate","startDate","date","Date","setDate","getDate","toStandardHisFormat","mapToOrders","prescriptions","getSessionDate","frequencyCount","drug_id","dose_strength","units","id","helpText","TT_MULTIPLE_SELECT","validation","options","getDrugOptions","onload","beforeNext","config","showKeyboard","footerBtns","visible","ok","TT_SELECT","condition","onValue"],"mappings":"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","file":"js/chunk-0a163f3e.6280f703.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    cancelDestinationPath: _ctx.cancelDestination,\n    fields: _ctx.fields,\n    activeField: _ctx.activeField,\n    onFinishAction: _ctx.onSubmit\n  }, null, 8, [\"cancelDestinationPath\", \"fields\", \"activeField\", \"onFinishAction\"]))\n}","import { ConceptName } from \"@/interfaces/conceptName\";\r\nimport { DrugInterface } from \"@/interfaces/Drug\";\r\nimport { AppEncounterService } from \"@/services/app_encounter_service\"\r\nimport { DrugOrderService } from \"@/services/drug_order_service\";\r\nimport { isEmpty } from \"lodash\";\r\n\r\nexport const DRUG_DOSE_FREQUENCIES: Record<number, string> = {\r\n  1: \"OD\", \r\n  2: \"BD\",\r\n  3: \"TDS\", \r\n  4: \"QID\"\r\n}\r\n\r\nexport const ANTI_MALARIA_DRUGS = [\r\n  {\r\n    'drug_id': 236,\r\n    'duration': 3,\r\n    'tabs': 6,\r\n    'name': \"Lumefantrine + Arthemether 1 x 6\",\r\n    'dose_strength': 1.0,\r\n    'units': \"tabs\",\r\n    'frequency': 2\r\n  },\r\n  {\r\n    'drug_id': 237,\r\n    'duration': 3,\r\n    'tabs': 12,\r\n    'name': \"Lumefantrine + Arthemether 2 x 6\",\r\n    'dose_strength': 2.0,\r\n    'units': \"tabs\",\r\n    'frequency': 2\r\n  },\r\n  {\r\n    'drug_id': 238,\r\n    'duration': 3,\r\n    'tabs': 18,\r\n    'name': \"Lumefantrine + Arthemether 3 x 6\",\r\n    'dose_strength': 3.0,\r\n    'units': \"tabs\",\r\n    'frequency': 2\r\n  },\r\n  {\r\n    'drug_id': 239,\r\n    'duration': 3,\r\n    'tabs': 24,\r\n    'name': \"Lumefantrine + Arthemether 4 x 6\",\r\n    'dose_strength': 4.0,\r\n    'units': \"tabs\",\r\n    'frequency': 2\r\n  }\r\n];\r\n\r\nexport class DrugPrescriptionService extends AppEncounterService {\r\n  drugs: ConceptName[] = [];\r\n  constructor(patientID: number, providerID: number) {\r\n    super(patientID, 25, providerID) \r\n  }\r\n  async loadDrugs(filter = '') {\r\n    this.drugs = await DrugPrescriptionService.getJson('drugs', {\r\n      'page_size': 1000000,\r\n      name: filter\r\n    })\r\n  }\r\n  getDrugOptions() {\r\n    if(isEmpty(this.drugs)) return []\r\n    return this.drugs.map(drug => ({\r\n      label: drug.name, value: drug.name, other: drug\r\n    }))\r\n  }\r\n  async hasMalaria() {\r\n    const malariaTestResult = await this.getMalariaTestResult()\r\n    if(malariaTestResult) return true\r\n    const malariaDiagnosis = await this.getMalariaDiagnosis()\r\n    if(malariaDiagnosis) return true\r\n    return false\r\n  }\r\n  async getMalariaTestResult() {\r\n    let malariaTestResult = await AppEncounterService.getFirstValueCoded(this.patientID, 'Malaria Test Result')   \r\n    if(malariaTestResult) return malariaTestResult\r\n    malariaTestResult = await AppEncounterService.getFirstValueText(this.patientID, 'Malaria Test Result')\r\n    if(malariaTestResult) return malariaTestResult\r\n    return null\r\n  }\r\n  async getMalariaDiagnosis() {\r\n    return AppEncounterService.getFirstValueCoded(this.patientID, 'Malaria')\r\n  }\r\n  createDrugOrder(drugOrders: Array<DrugInterface>){\r\n    return DrugOrderService.create({\r\n      'encounter_id': this.encounterID,\r\n      'drug_orders': drugOrders\r\n    })\r\n  }\r\n}","import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createBlock as _createBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, withScopeId as _withScopeId, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-586626f5\")\n\n_pushScopeId(\"data-v-586626f5\")\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"Complete prescription details\")\nconst _hoisted_2 = { class: \"side-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" Close \")\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"Save \")\n_popScopeId()\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_title = _resolveComponent(\"ion-title\")\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")\n  const _component_ion_header = _resolveComponent(\"ion-header\")\n  const _component_ion_label = _resolveComponent(\"ion-label\")\n  const _component_ion_item = _resolveComponent(\"ion-item\")\n  const _component_ion_list = _resolveComponent(\"ion-list\")\n  const _component_ion_col = _resolveComponent(\"ion-col\")\n  const _component_frequency_card = _resolveComponent(\"frequency-card\")\n  const _component_ion_row = _resolveComponent(\"ion-row\")\n  const _component_interval_keyboard = _resolveComponent(\"interval-keyboard\")\n  const _component_ion_grid = _resolveComponent(\"ion-grid\")\n  const _component_ion_content = _resolveComponent(\"ion-content\")\n  const _component_ion_button = _resolveComponent(\"ion-button\")\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")\n\n  return (_openBlock(), _createBlock(_Fragment, null, [\n    _createVNode(_component_ion_header, null, {\n      default: _withId(() => [\n        _createVNode(_component_ion_toolbar, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_title, null, {\n              default: _withId(() => [\n                _hoisted_1\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_content, { style: { overflowY: 'hidden', background: 'grey' } }, {\n      default: _withId(() => [\n        _createVNode(_component_ion_grid, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_row, null, {\n              default: _withId(() => [\n                _createVNode(_component_ion_col, { size: \"4\" }, {\n                  default: _withId(() => [\n                    _createVNode(_component_ion_list, { style: {overflowY: 'auto', height:'78vh', borderRight: 'solid 1px #ccc'} }, {\n                      default: _withId(() => [\n                        (_openBlock(true), _createBlock(_Fragment, null, _renderList(_ctx.drugs, (drug, index) => {\n                          return (_openBlock(), _createBlock(_component_ion_item, {\n                            key: drug,\n                            detail: true,\n                            onClick: () => _ctx.activeIndex = index,\n                            color: _ctx.activeIndex === index ? 'light' : ''\n                          }, {\n                            default: _withId(() => [\n                              _createVNode(_component_ion_label, null, {\n                                default: _withId(() => [\n                                  _createTextVNode(_toDisplayString(drug.name), 1 /* TEXT */)\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ]),\n                            _: 2\n                          }, 1032, [\"onClick\", \"color\"]))\n                        }), 128 /* KEYED_FRAGMENT */))\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_ion_col, { style: {overflowY: 'auto', height:'78vh'} }, {\n                  default: _withId(() => [\n                    (_ctx.activeIndex >= 0)\n                      ? (_openBlock(), _createBlock(_Fragment, { key: 0 }, [\n                          _createVNode(\"div\", _hoisted_2, _toDisplayString(_ctx.instructions), 1),\n                          _createVNode(_component_ion_row, { class: \"frequencies\" }, {\n                            default: _withId(() => [\n                              (_openBlock(true), _createBlock(_Fragment, null, _renderList(Object.keys(_ctx.frequencies), (key) => {\n                                return (_openBlock(), _createBlock(_component_ion_col, { key: key }, {\n                                  default: _withId(() => [\n                                    _createVNode(_component_frequency_card, {\n                                      title: key,\n                                      status: _ctx.frequencies[key],\n                                      onClick: $event => (_ctx.setFrequency(key))\n                                    }, null, 8, [\"title\", \"status\", \"onClick\"])\n                                  ]),\n                                  _: 2\n                                }, 1024))\n                              }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            _: 1\n                          }),\n                          _createVNode(_component_interval_keyboard, {\n                            unit: \"days\",\n                            title: \"Select Duration\",\n                            onOnValue: _ctx.setDuration\n                          }, null, 8, [\"onOnValue\"])\n                        ], 64 /* STABLE_FRAGMENT */))\n                      : _createCommentVNode(\"\", true)\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    }),\n    _createVNode(_component_ion_footer, null, {\n      default: _withId(() => [\n        _createVNode(_component_ion_toolbar, null, {\n          default: _withId(() => [\n            _createVNode(_component_ion_button, {\n              onClick: _ctx.closeModal,\n              slot: \"start\",\n              color: \"danger\",\n              style: {\"margin-left\":\"1rem\"}\n            }, {\n              default: _withId(() => [\n                _hoisted_3\n              ]),\n              _: 1\n            }, 8, [\"onClick\"]),\n            _createVNode(_component_ion_button, {\n              onClick: _ctx.savePrescriptions,\n              slot: \"end\",\n              style: {\"margin-right\":\"1rem\"}\n            }, {\n              default: _withId(() => [\n                _hoisted_4\n              ]),\n              _: 1\n            }, 8, [\"onClick\"])\n          ]),\n          _: 1\n        })\n      ]),\n      _: 1\n    })\n  ], 64 /* STABLE_FRAGMENT */))\n})","import { createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, withScopeId as _withScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-0dd8dfe4\")\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_card_subtitle = _resolveComponent(\"ion-card-subtitle\")\n  const _component_ion_card_content = _resolveComponent(\"ion-card-content\")\n  const _component_ion_card = _resolveComponent(\"ion-card\")\n\n  return (_openBlock(), _createBlock(_component_ion_card, {\n    class: [\"his-card clickable\", { active: _ctx.status }]\n  }, {\n    default: _withId(() => [\n      _createVNode(\"img\", {\n        src: _ctx.icon,\n        alt: _ctx.title,\n        height: \"65\"\n      }, null, 8, [\"src\", \"alt\"]),\n      _createVNode(_component_ion_card_content, null, {\n        default: _withId(() => [\n          _createVNode(_component_ion_card_subtitle, {\n            color: _ctx.status ? 'primary': ''\n          }, {\n            default: _withId(() => [\n              _createTextVNode(_toDisplayString(_ctx.cardTitle), 1 /* TEXT */)\n            ]),\n            _: 1\n          }, 8, [\"color\"])\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }, 8, [\"class\"]))\n})","\r\nimport { computed, defineComponent } from 'vue'\r\nimport Strings from '../utils/Strings'\r\nimport { IonCard, IonCardContent, IonCardSubtitle } from \"@ionic/vue\";\r\n\r\nexport default defineComponent({\r\n  props: {\r\n    title: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    status: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  components: { IonCard, IonCardContent, IonCardSubtitle },\r\n  setup(props) {\r\n    const cardTitle = computed(() => Strings.capitalizeFirstLetter(props.title))\r\n    const icon = computed(() => `/assets/images/prescription/${props.title}.png`)\r\n\r\n    return {\r\n      cardTitle,\r\n      icon,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./FrequencyCard.vue?vue&type=template&id=0dd8dfe4&scoped=true&ts=true\"\nimport script from \"./FrequencyCard.vue?vue&type=script&lang=ts\"\nexport * from \"./FrequencyCard.vue?vue&type=script&lang=ts\"\n\nimport \"./FrequencyCard.vue?vue&type=style&index=0&id=0dd8dfe4&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\msuleman\\\\projects\\\\HIS-Core\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0dd8dfe4\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, withScopeId as _withScopeId } from \"vue\"\nconst _withId = /*#__PURE__*/_withScopeId(\"data-v-5bd3374e\")\n\nexport const render = /*#__PURE__*/_withId(function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_label = _resolveComponent(\"ion-label\")\n  const _component_ion_item = _resolveComponent(\"ion-item\")\n  const _component_ion_list = _resolveComponent(\"ion-list\")\n  const _component_ion_col = _resolveComponent(\"ion-col\")\n  const _component_his_keyboard = _resolveComponent(\"his-keyboard\")\n  const _component_ion_row = _resolveComponent(\"ion-row\")\n\n  return (_openBlock(), _createBlock(_component_ion_row, { class: \"ion-margin-vertical border\" }, {\n    default: _withId(() => [\n      _createVNode(_component_ion_col, { size: \"4\" }, {\n        default: _withId(() => [\n          _createVNode(_component_ion_list, null, {\n            default: _withId(() => [\n              _createVNode(_component_ion_item, null, {\n                default: _withId(() => [\n                  _createVNode(_component_ion_label, null, {\n                    default: _withId(() => [\n                      _createTextVNode(_toDisplayString(_ctx.title), 1 /* TEXT */)\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }),\n              (_openBlock(true), _createBlock(_Fragment, null, _renderList(_ctx.ranges, (range, index) => {\n                return (_openBlock(), _createBlock(_component_ion_item, {\n                  key: range,\n                  color: _ctx.activeIndex === index ? 'light': '',\n                  detail: true,\n                  onClick: $event => (_ctx.generateKeypad(range))\n                }, {\n                  default: _withId(() => [\n                    _createVNode(_component_ion_label, null, {\n                      default: _withId(() => [\n                        _createTextVNode(_toDisplayString(range.start + ' - ' + range.end + ' ' + _ctx.unit), 1 /* TEXT */)\n                      ]),\n                      _: 2\n                    }, 1024)\n                  ]),\n                  _: 2\n                }, 1032, [\"color\", \"onClick\"]))\n              }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      (_ctx.keyboard)\n        ? (_openBlock(), _createBlock(_component_ion_col, { key: 0 }, {\n            default: _withId(() => [\n              _createVNode(_component_his_keyboard, {\n                kbConfig: _ctx.keyboard,\n                onKeyPress: _ctx.onKeyPress,\n                disabled: false,\n                style: {\"border\":\"0\"}\n              }, null, 8, [\"kbConfig\", \"onKeyPress\"])\n            ]),\n            _: 1\n          }))\n        : _createCommentVNode(\"\", true)\n    ]),\n    _: 1\n  }))\n})","\r\nimport { defineComponent, onMounted, ref } from 'vue'\r\nimport HisKeyboard from \"@/components/Keyboard/HisKeyboard.vue\";\r\nimport { IonRow, IonCol, IonList, IonItem, IonLabel } from \"@ionic/vue\";\r\n\r\nexport default defineComponent({\r\n  props: {\r\n    unit: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    title: {\r\n      type: String,\r\n      default: 'Select Numbers'\r\n    }\r\n  },\r\n  components: { \r\n    HisKeyboard, \r\n    IonRow, \r\n    IonCol, \r\n    IonList, \r\n    IonItem, \r\n    IonLabel\r\n  },\r\n  emits: ['onValue'],\r\n  setup(_, { emit }) {\r\n    const ranges = ref([\r\n      {start: 1, end: 20},\r\n      {start: 21, end: 40},\r\n      {start: 41, end: 60},\r\n      {start: 61, end: 80}\r\n    ])\r\n    const activeIndex = ref(0)\r\n    const keyboard = ref<Array<any>>()\r\n    const onKeyPress = (text: any) => emit('onValue', text)\r\n    const generateKeypad = (range: any) => {\r\n      const numbers: string[][] = [[]]\r\n      let row = 0\r\n      let counter = 0     \r\n      for (let i = range.start; i <= range.end; i++){\r\n        if(counter > 4) {\r\n          ++row\r\n          numbers[row] = [],\r\n          counter = 0\r\n        }\r\n        numbers[row].push(`${i}`)\r\n        ++counter\r\n      }\r\n      keyboard.value =  [numbers, []]\r\n      activeIndex.value = ranges.value.findIndex(r => r.start === range.start)\r\n    }\r\n    onMounted(() => generateKeypad(ranges.value[0]))\r\n    return {\r\n      keyboard,\r\n      onKeyPress,\r\n      generateKeypad,\r\n      ranges,\r\n      activeIndex,\r\n    }\r\n  },\r\n})\r\n","import { render } from \"./HisIntervalKeyboard.vue?vue&type=template&id=5bd3374e&scoped=true&ts=true\"\nimport script from \"./HisIntervalKeyboard.vue?vue&type=script&lang=ts\"\nexport * from \"./HisIntervalKeyboard.vue?vue&type=script&lang=ts\"\n\nimport \"./HisIntervalKeyboard.vue?vue&type=style&index=0&id=5bd3374e&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\msuleman\\\\projects\\\\HIS-Core\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-5bd3374e\"]])\n\nexport default __exports__","\r\nimport {\r\n  IonContent,\r\n  IonButton,\r\n  IonHeader,\r\n  IonTitle,\r\n  IonToolbar,\r\n  IonLabel,\r\n  modalController,\r\n  IonList,\r\n  IonItem,\r\n  IonRow,\r\n} from \"@ionic/vue\";\r\nimport { computed, defineComponent, PropType, ref} from \"vue\";\r\nimport { Option } from \"@/components/Forms/FieldInterface\";\r\nimport FrequencyCard from \"./FrequencyCard.vue\";\r\nimport IntervalKeyboard from \"@/components/Keyboard/HisIntervalKeyboard.vue\";\r\nimport { toastWarning } from \"@/utils/Alerts\";\r\n\r\nexport default defineComponent({\r\n  name: \"PrescriptionModal\",\r\n  props: {\r\n    prescribedDrugs: {\r\n      type: Object as PropType<Option[]>, \r\n      required: true\r\n    },\r\n  },\r\n  setup (props) {\r\n    const activeIndex = ref(-1)  \r\n    const drugs = computed(() => props.prescribedDrugs.map(d => {\r\n      const drug = d.other\r\n      drug.duration = 0\r\n      drug.frequency = {\r\n        morning: false,\r\n        noon: false,\r\n        evening: false,\r\n        night: false,\r\n      }\r\n      return drug\r\n    }))\r\n    const getFrequencyCount = (frequency: Record<string, boolean>) => {\r\n      return Object.values(frequency).filter(value => value).length\r\n    }\r\n    const instructions = computed(() => {\r\n      if(activeIndex.value < 0) return ''\r\n      const drugname = drugs.value[activeIndex.value].name\r\n      const freq = getFrequencyCount(drugs.value[activeIndex.value].frequency)\r\n      const duration = drugs.value[activeIndex.value].duration\r\n      return `${drugname}, ${freq} time(s) a day, for ${duration} day(s)` \r\n    })\r\n    const frequencies = computed(() => {\r\n      if(activeIndex.value < 0) return {}\r\n      return drugs.value[activeIndex.value].frequency\r\n    })\r\n    const setFrequency = (index: string) => {\r\n      drugs.value[activeIndex.value].frequency[index] = !drugs.value[activeIndex.value].frequency[index]\r\n    }\r\n    const setDuration = (text: string) => {\r\n      drugs.value[activeIndex.value].duration = parseInt(text)\r\n    }\r\n    const isComplete = () => {\r\n      for (const drug of drugs.value) {\r\n        const freq = getFrequencyCount(drug.frequency)\r\n        const duration: number = drug.duration\r\n        if(!freq  || !duration){\r\n          toastWarning(`complete prescription details for ${drug.name}`)\r\n          return false\r\n        }\r\n      }\r\n      return true\r\n    }\r\n    const savePrescriptions = () => {\r\n      if(isComplete()) {\r\n        modalController.dismiss(drugs.value)\r\n      }\r\n    }\r\n    const closeModal = () => modalController.dismiss()\r\n    return {\r\n      drugs,\r\n      activeIndex,\r\n      instructions,\r\n      frequencies,\r\n      closeModal,\r\n      setFrequency,\r\n      setDuration,\r\n      savePrescriptions,\r\n    }\r\n  },\r\n  components: {\r\n    IonContent,\r\n    IonButton,\r\n    IonHeader,\r\n    IonTitle,\r\n    IonToolbar,\r\n    IonLabel,\r\n    IonList,\r\n    IonItem,\r\n    IonRow,\r\n    FrequencyCard,\r\n    IntervalKeyboard\r\n},\r\n});\r\n","import { render } from \"./PrescriptionModal.vue?vue&type=template&id=586626f5&scoped=true&ts=true\"\nimport script from \"./PrescriptionModal.vue?vue&type=script&lang=ts\"\nexport * from \"./PrescriptionModal.vue?vue&type=script&lang=ts\"\n\nimport \"./PrescriptionModal.vue?vue&type=style&index=0&id=586626f5&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\msuleman\\\\projects\\\\HIS-Core\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-586626f5\"]])\n\nexport default __exports__","\r\nimport { defineComponent} from 'vue'\r\nimport HisStandardForm from \"@/components/Forms/TouchScreenForm.vue\";\r\nimport EncounterMixinVue from '@/views/EncounterMixin.vue';\r\nimport Validation from '@/components/Forms/validations/StandardValidations';\r\nimport { Field, Option } from '@/components/Forms/FieldInterface';\r\nimport { FieldType } from '@/components/Forms/BaseFormElements';\r\nimport { isEmpty } from 'lodash';\r\nimport { ANTI_MALARIA_DRUGS, DrugPrescriptionService, DRUG_DOSE_FREQUENCIES } from '../../services/drug_prescription_service';\r\nimport { modalController } from '@ionic/core';\r\nimport PrescriptionModalVue from '@/apps/OPD/components/PrescriptionModal.vue';\r\nimport HisDate from \"@/utils/Date\"\r\nimport { alertConfirmation, toastSuccess, toastWarning } from '@/utils/Alerts';\r\n\r\nexport default defineComponent({\r\n  components: { HisStandardForm },\r\n  mixins: [EncounterMixinVue],\r\n  data: () => ({\r\n    activeField: '',\r\n    prescriptionService: {} as any,\r\n    hasMalaria: false,\r\n    drugOrders: [] as any\r\n  }),\r\n  watch: {\r\n    ready: {\r\n      async handler(isReady: boolean) {\r\n        if(isReady){\r\n          this.prescriptionService = new DrugPrescriptionService(this.patientID, this.providerID)\r\n          await this.prescriptionService.loadDrugs()    \r\n          this.hasMalaria = await this.prescriptionService.hasMalaria()\r\n          this.fields = this.getFields()\r\n        }\r\n      },\r\n      immediate: true,\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    async onSubmit(){   \r\n      const encounter = await this.prescriptionService.createEncounter()\r\n      if (!encounter) return toastWarning('Unable to create treatment encounter')   \r\n      const drugOrder = await this.prescriptionService.createDrugOrder(this.drugOrders);\r\n      if(!drugOrder) return toastWarning('Unable to create drug orders!')\r\n      toastSuccess('Drug order has been created')\r\n      this.nextTask()       \r\n    },\r\n    async getPrescriptionDetails(prescribedDrugs: Option[]) {\r\n      const modal = await modalController.create({\r\n        component: PrescriptionModalVue,\r\n        backdropDismiss: false,\r\n        cssClass: \"large-modal\",\r\n        componentProps: {\r\n          prescribedDrugs\r\n        }\r\n      });\r\n      modal.present();\r\n      const { data } = await modal.onDidDismiss();\r\n      return data\r\n    },\r\n    getFrequencyCount(frequency: Record<string, boolean>) {\r\n      return Object.values(frequency).filter(value => value).length\r\n    },\r\n    calculateExpireDate(startDate: string | Date, duration: number ) {\r\n      const date = new Date(startDate)\r\n      date.setDate(date.getDate() + duration)\r\n      return HisDate.toStandardHisFormat(date)\r\n    },\r\n    mapToOrders(prescriptions: any[]): any[] {\r\n      return prescriptions.map(drug => {\r\n        const startDate = DrugPrescriptionService.getSessionDate()\r\n        const frequencyCount = (typeof drug.frequency === 'number') ? drug.frequency :  this.getFrequencyCount(drug.frequency)\r\n        const frequency = DRUG_DOSE_FREQUENCIES[frequencyCount]\r\n        return {\r\n          'drug_inventory_id': drug.drug_id,\r\n          'equivalent_daily_dose': drug.dose_strength * frequencyCount,\r\n          'start_date': startDate,\r\n          'auto_expire_date': this.calculateExpireDate(startDate, drug.duration), \r\n          'units': drug.units,\r\n          'instructions': `${drug.name}: ${frequencyCount} ${frequency} for ${drug.duration}`,\r\n          'dose': drug.dose_strength,\r\n          'frequency': frequency\r\n        }\r\n      })\r\n    },\r\n    getFields(): Array<Field>{\r\n      return [\r\n        {\r\n          id: 'drugs',\r\n          helpText: 'Select drugs',\r\n          type: FieldType.TT_MULTIPLE_SELECT,\r\n          validation: (data: any) => Validation.required(data),\r\n          options: () => this.prescriptionService.getDrugOptions(),\r\n          onload: () => this.activeField = '',\r\n          beforeNext: async (data: Option[]) => {\r\n            const prescriptions = await this.getPrescriptionDetails(data)\r\n            if(isEmpty(prescriptions)) return false\r\n            this.drugOrders = this.mapToOrders(prescriptions)\r\n            return true\r\n          },\r\n          config: {\r\n            showKeyboard: true,\r\n            footerBtns: [\r\n              {\r\n                name: 'Predefined Malaria Drugs',\r\n                color: 'primary',\r\n                size: 'large',\r\n                visible: false,\r\n                slot: 'end',\r\n                onClick: async () => {\r\n                  if(this.hasMalaria) this.activeField = 'malaria_drugs'\r\n                  const ok = await alertConfirmation('Patient has no malaria. Do you still want to prescribe anti malaria drugs?')\r\n                  if(ok) this.activeField = 'malaria_drugs'\r\n                }\r\n              },\r\n            ]\r\n          }\r\n        },\r\n        {\r\n          id: 'malaria_drugs',\r\n          helpText: \"select Malaria Drugs\",\r\n          validation: (data: any) => Validation.required(data),\r\n          type: FieldType.TT_SELECT,\r\n          condition: () => this.activeField === 'malaria_drugs',\r\n          onValue: (data: Option) => {\r\n            if(isEmpty(data)) return false\r\n            this.drugOrders = this.mapToOrders([data.other])\r\n            return true\r\n          },\r\n          options: () => ANTI_MALARIA_DRUGS.map(drug => ({\r\n            label: `${drug.name}, ${drug.frequency} time(s) a day, for ${drug.duration} days`,\r\n            value: drug.name,\r\n            other: drug\r\n          }))\r\n        }\r\n      ]\r\n    }\r\n  }\r\n})\r\n","import { render } from \"./Prescription.vue?vue&type=template&id=7d9a3f5c&ts=true\"\nimport script from \"./Prescription.vue?vue&type=script&lang=ts\"\nexport * from \"./Prescription.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"C:\\\\Users\\\\msuleman\\\\projects\\\\HIS-Core\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./FrequencyCard.vue?vue&type=style&index=0&id=0dd8dfe4&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./HisIntervalKeyboard.vue?vue&type=style&index=0&id=5bd3374e&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PrescriptionModal.vue?vue&type=style&index=0&id=586626f5&scoped=true&lang=css\""],"sourceRoot":""}