(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c1c8555"],{"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,s=n("44d2"),r=n("ae40"),o="find",c=!0,u=r(o);o in[]&&Array(1)[o]((function(){c=!1})),i({target:"Array",proto:!0,forced:c||!u},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},a16a6:function(e,t,n){"use strict";n.r(t);var i=n("7a23");function a(e,t,n,a,s,r){var o=Object(i["resolveComponent"])("his-standard-form");return Object(i["openBlock"])(),Object(i["createBlock"])(o,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}n("7db0"),n("d81d"),n("b0c0");var s=n("9ab4"),r=n("9441"),o=n("7365"),c=n("cc6f"),u=n("8158"),l=function(e){function t(t,n){return e.call(this,t,8,n)||this}return Object(s["c"])(t,e),t.getDiagnosis=function(){return Object(s["b"])(this,void 0,void 0,(function(){var e;return Object(s["d"])(this,(function(t){return e=u["a"].getConceptID("Qech outpatient diagnosis list"),[2,c["a"].getJson("concept_set",{id:e})]}))}))},t.getMalariaTestResult=function(e){return Object(s["b"])(this,void 0,void 0,(function(){var t;return Object(s["d"])(this,(function(n){switch(n.label){case 0:return[4,c["a"].getFirstValueCoded(e,"Malaria Test Result")];case 1:return t=n.sent(),t?[2,t]:[4,c["a"].getFirstValueText(e,"Malaria Test Result")];case 2:return t=n.sent(),t?[2,t]:[2,null]}}))}))},t}(c["a"]),d=function(e){function t(t,n){return e.call(this,t,105,n)||this}return Object(s["c"])(t,e),t}(c["a"]),f=n("2706"),h=n("d95e"),b=n("2ef0"),v=Object(i["defineComponent"])({components:{HisStandardForm:r["a"]},mixins:[o["a"]],data:function(){return{activeField:"",notesService:{},diagnosisList:[],diagnosisService:{},malariaTestResult:null}},watch:{ready:{handler:function(e){return Object(s["b"])(this,void 0,void 0,(function(){var t,n;return Object(s["d"])(this,(function(i){switch(i.label){case 0:return e?(t=this,[4,l.getMalariaTestResult(this.patientID)]):[3,3];case 1:return t.malariaTestResult=i.sent(),this.notesService=new d(this.patientID,this.providerID),this.diagnosisService=new l(this.patientID,this.providerID),n=this,[4,l.getDiagnosis()];case 2:n.diagnosisList=i.sent(),this.fields=this.getFields(),i.label=3;case 3:return[2]}}))}))},immediate:!0,deep:!0}},methods:{onSubmit:function(e,t){return Object(s["b"])(this,void 0,void 0,(function(){var e,n;return Object(s["d"])(this,(function(i){switch(i.label){case 0:return[4,this.diagnosisService.createEncounter()];case 1:return i.sent(),[4,this.notesService.createEncounter()];case 2:return i.sent(),[4,this.resolveObs(Object(s["a"])({},t),"diagnosis")];case 3:return e=i.sent(),[4,this.diagnosisService.saveObservationList(e)];case 4:return i.sent(),[4,this.resolveObs(Object(s["a"])({},t),"notes")];case 5:return n=i.sent(),[4,this.notesService.saveObservationList(n)];case 6:return i.sent(),this.nextTask(),[2]}}))}))},mapListToOptions:function(e){return Object(b["isEmpty"])(e)?[]:e.map((function(e){return{label:e.name,value:e.name,other:e.concept_id}})).sort((function(e,t){return e.label<t.label?-1:e.label>t.label?1:0}))},checkMalariaResult:function(e){var t=e.find((function(e){return"Malaria"===e.label}));if(t){if(!this.malariaTestResult)return["No malaria test result found"];if("Negative"===this.malariaTestResult)return["Negative malaria test results detected"]}return null},getFields:function(){var e=this;return[{id:"primary_diagnosis",helpText:"Select primary diagnosis",type:h["b"].TT_MULTIPLE_SELECT,validation:function(t){return e.validateSeries([function(){return f["a"].required(t)},function(){return e.checkMalariaResult(t)}])},options:function(){return e.mapListToOptions(e.diagnosisList)},computedValue:function(t){return{tag:"diagnosis",obs:t.map((function(t){var n=t.other;return e.diagnosisService.buildValueCodedFromConceptId("Primary diagnosis",n)}))}},summaryMapValue:function(e){var t=e.value;return{value:t,label:"Primary diagnosis"}},config:{showKeyboard:!0}},{id:"secondary_diagnosis",helpText:"Select secondary diagnosis",type:h["b"].TT_MULTIPLE_SELECT,options:function(){return e.mapListToOptions(e.diagnosisList)},validation:function(t){return e.checkMalariaResult(t)},computedValue:function(t){return{tag:"diagnosis",obs:t.map((function(t){var n=t.other;return e.diagnosisService.buildValueCodedFromConceptId("Secondary diagnosis",n)}))}},summaryMapValue:function(e){var t=e.value;return{value:t,label:"Secondary diagnosis"}},config:{showKeyboard:!0}},{id:"clinical_notes",helpText:"Clinical notes",type:h["b"].TT_TEXT,computedValue:function(t){var n=t.value;return{tag:"notes",obs:e.notesService.buildValueText("Clinical notes construct",n)}}}]}}}),p=n("d959"),g=n.n(p);const m=g()(v,[["render",a]]);t["default"]=m}}]);
//# sourceMappingURL=chunk-6c1c8555.476e8847.js.map